<!DOCTYPE html>
<html>
  <head>
    <link rel="stylesheet" href="src/styles/main.css" />
  </head>
  <body>
    <!-- Login View (shown when not authenticated) -->
    <div id="loginView" class="view login-view">
      <div class="login-background"></div>
      <div class="login-content">
        <!-- Warning Card -->
        <div id="warning" class="auth-card">
          <h1 class="auth-title">granblue.team</h1>
          <div class="auth-body">
            <p>
              This extension only reads data your browser has already received.
              It does NOT make additional requests to GBF servers or modify game behavior.
            </p>
            <p>
              While this is the safest approach, third-party tools are technically
              against Terms of Service. Use at your own risk.
            </p>
            <p>
              granblue.team assumes no responsibility for any account suspensions
              or bans that may result from its use.
            </p>
          </div>
          <button id="acknowledgeButton" class="button btn-primary full">I understand</button>
        </div>

        <!-- Login Card (shown after acknowledging warning) -->
        <div id="loginFormContainer" class="auth-card hidden">
          <h1 class="auth-title">Log in</h1>
          <div id="loginForm" class="auth-form">
            <input type="email" id="loginUsername" class="contained" placeholder="Email address" />
            <input type="password" id="loginPassword" class="contained" placeholder="Password" />
            <div id="loginStatus" class="hidden"></div>
            <button id="loginButton" class="button btn-primary full">Log in</button>
          </div>
          <div class="auth-footer">
            <span>Don't have an account?</span>
            <a target="_blank" href="https://next.granblue.team/auth/register">Create one</a>
          </div>
        </div>
      </div>
    </div>

    <!-- Main View (shown when authenticated) -->
    <div id="mainView" class="view hidden">
      <!-- Tab Navigation -->
      <nav class="tabs">
        <button class="tab active" data-tab="party">Party</button>
        <button class="tab" data-tab="collection">Collection</button>
        <button class="tab hidden" data-tab="database" id="databaseTab">Database</button>
        <button class="tab tab-profile" data-tab="profile">
          <img
            id="tabAvatar"
            class="tab-avatar"
            src="https://siero-img.s3-us-west-2.amazonaws.com/profile/npc@2x.png"
          />
        </button>
      </nav>

      <!-- Tab Content -->
      <div class="tab-content">
        <!-- Party Tab -->
        <div id="partyPanel" class="panel active">
          <div id="partyItems" class="cache-items">
            <p class="cache-empty">Browse a party in game to capture data</p>
          </div>
          <div id="partyNotice" class="notice hidden">
            <p id="partyStatus"></p>
          </div>
        </div>

        <!-- Collection Tab -->
        <div id="collectionPanel" class="panel">
          <div id="collectionItems" class="cache-items">
            <p class="cache-empty">Browse your collection pages to capture data</p>
          </div>
          <div id="collectionNotice" class="notice hidden">
            <p id="collectionStatus"></p>
          </div>
        </div>

        <!-- Database Tab (admin only) -->
        <div id="databasePanel" class="panel">
          <div id="databaseItems" class="cache-items">
            <p class="cache-empty">Browse detail pages to capture data</p>
          </div>
          <div id="databaseNotice" class="notice hidden">
            <p id="databaseStatus"></p>
          </div>
        </div>

        <!-- Profile Tab -->
        <div id="profilePanel" class="panel">
          <a id="viewProfile" class="profile-header" href="#" target="_blank">
            <img
              id="profileAvatar"
              class="avatar-large"
              src="https://siero-img.s3-us-west-2.amazonaws.com/profile/npc@2x.png"
            />
            <span id="profileUsername" class="profile-username">Username</span>
          </a>

          <div class="profile-footer">
            <button id="clearCacheButton" class="button">Clear captured data</button>
            <button id="showWarning" class="button">Show extension disclaimer</button>
            <button id="logoutButton" class="button btn-stroke">Log out</button>
          </div>
        </div>
      </div>

      <!-- Detail View (slides over tab content) -->
      <div id="detailView" class="detail-view">
        <header class="detail-header">
          <button id="detailBack" class="detail-back">
            <svg class="icon-chevron" viewBox="0 0 14 14" fill="currentColor">
              <path d="M9.82906 2.04309C9.43862 1.6528 8.8055 1.6529 8.415 2.04309L4.17281 6.28625C4.0002 6.45893 3.9037 6.67885 3.88375 6.90442C3.85638 7.19118 3.95321 7.48755 4.17281 7.70715L8.415 11.9503C8.80545 12.3402 9.43867 12.3403 9.82906 11.9503C10.2192 11.5599 10.219 10.9267 9.82906 10.5363L6.29098 6.99622L9.82906 3.45715C10.2192 3.06673 10.2191 2.43355 9.82906 2.04309Z" fill="currentColor"/>
            </svg>
            <span>Back</span>
          </button>
          <div class="detail-actions">
            <button id="detailCopy" class="button small">Copy</button>
            <button id="detailImport" class="button small">Import</button>
          </div>
        </header>
        <div class="detail-meta">
          <div class="detail-meta-left">
            <span id="detailPageCount"></span>
            <span id="detailItemCount"></span>
          </div>
          <div class="detail-filter hidden" id="detailFilter">
            <button class="filter-button" id="filterButton">
              <span>SSR</span>
              <svg class="filter-chevron" viewBox="0 0 14 14" fill="currentColor">
                <path d="M3.45715 4.17094C3.06673 4.56138 3.0669 5.1945 3.45715 5.585L6.99622 9.12309C7.38673 9.51355 8.01985 9.51355 8.41031 9.12309L11.9494 5.585C12.3398 5.19455 12.3398 4.56133 11.9494 4.17094C11.5589 3.78079 10.9258 3.78097 10.5353 4.17094L7.70317 7.00406L4.87094 4.17094C4.48053 3.78082 3.84735 3.78088 3.45715 4.17094Z"/>
              </svg>
            </button>
            <div class="filter-dropdown" id="filterDropdown">
              <label class="filter-option">
                <input type="checkbox" value="4" checked disabled>
                <span>SSR</span>
              </label>
              <label class="filter-option">
                <input type="checkbox" value="3">
                <span>SR</span>
              </label>
              <label class="filter-option">
                <input type="checkbox" value="2">
                <span>R</span>
              </label>
              <div class="filter-divider hidden" id="lv1FilterDivider"></div>
              <label class="filter-option hidden" id="lv1FilterOption">
                <input type="checkbox" id="excludeLv1Checkbox" checked>
                <span>Exclude Lv1</span>
              </label>
            </div>
          </div>
          <span id="detailFreshness"></span>
        </div>
        <div id="detailItems" class="detail-items">
          <!-- Items rendered here -->
        </div>
        <div id="detailSelectionBar" class="selection-bar hidden">
          <button id="selectAllBtn" class="button small">Select all</button>
          <button id="unselectAllBtn" class="button small btn-stroke">Unselect all</button>
        </div>
      </div>
    </div>

    <!-- Toast -->
    <div id="toast" class="toast"></div>

    <script type="module" src="src/main.js"></script>
  </body>
</html>
